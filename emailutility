# Add table data rows
for data_row in csv_data[1:]:
    html_table += "<tr>"
    for idx, cell in enumerate(data_row):
        # Skip the second column (index 1)
        if idx != 1:
            # Apply red background for "Failed" status and "Duration" > 1 hour
            if idx == 2 and cell != "completed":
                html_table += f"<td style='background-color: red;'>{cell}</td>"
            elif idx == 5 and int(cell.split(':')[0]) > 1:
                html_table += f"<td style='background-color: red;'>{cell}</td>"
            else:
                html_table += f"<td>{cell}</td>"
    html_table += "</tr>"

html_table += "</table>"

# Write the HTML table to a file
with open(html_filename, 'w') as file:
    file.write(html_table)

print(f"CSV data converted to HTML table and saved to '{html_filename}'.")

