import csv
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText

# Read the CSV data from the file
csv_filename = 'output_file_YYYY-MM-DD.csv'  # Replace with your actual CSV filename
html_filename = 'output_table.html'  # Output HTML filename
csv_data = []

with open(csv_filename, 'r') as csv_file:
    reader = csv.reader(csv_file)
    for row in reader:
        csv_data.append(row)

# Create an HTML table
html_table = "<table border='1'>"

# Add table header row
html_table += "<tr>"
for header in csv_data[0]:
    html_table += f"<th>{header}</th>"
html_table += "</tr>"

# Add table data rows
for data_row in csv_data[1:]:
    html_table += "<tr>"
    for cell in data_row:
        html_table += f"<td>{cell}</td>"
    html_table += "</tr>"

html_table += "</table>"

# Create an SMTP server connection
smtp_host = 'smtp.gmail.com'  # Replace with your SMTP server address
smtp_port = 587  # Replace with your SMTP server port
smtp_username = 'your_email@gmail.com'  # Replace with your email address
smtp_password = 'your_email_password'  # Replace with your email password

server = smtplib.SMTP(smtp_host, smtp_port)
server.starttls()
server.login(smtp_username, smtp_password)

# Compose the email message
msg = MIMEMultipart('alternative')
msg['From'] = smtp_username
msg['To'] = 'recipient@example.com'  # Replace with the recipient's email address
msg['Subject'] = 'CSV Data as HTML Table'

# Attach the HTML table to the email
part = MIMEText(html_table, 'html')
msg.attach(part)

# Send the email
server.sendmail(smtp_username, 'recipient@example.com', msg.as_string())

# Close the SMTP server connection
server.quit()

print("Email sent successfully.")
